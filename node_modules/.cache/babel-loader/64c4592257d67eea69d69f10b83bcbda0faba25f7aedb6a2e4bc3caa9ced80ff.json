{"ast":null,"code":"import { createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, toDisplayString as _toDisplayString, createTextVNode as _createTextVNode, withModifiers as _withModifiers, resolveComponent as _resolveComponent, withCtx as _withCtx, createVNode as _createVNode, openBlock as _openBlock, createElementBlock as _createElementBlock } from \"vue\";\nconst _hoisted_1 = {\n  class: \"container mt-4\"\n};\nconst _hoisted_2 = {\n  class: \"list-group mb-4\"\n};\nconst _hoisted_3 = {\n  class: \"list-group-item\"\n};\nconst _hoisted_4 = {\n  class: \"list-group-item\"\n};\nconst _hoisted_5 = {\n  class: \"list-group-item\"\n};\nconst _hoisted_6 = {\n  class: \"list-group-item\"\n};\nconst _hoisted_7 = {\n  class: \"list-group-item\"\n};\nconst _hoisted_8 = {\n  class: \"list-group-item\"\n};\nconst _hoisted_9 = {\n  class: \"list-group-item\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_router_link = _resolveComponent(\"router-link\");\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_cache[16] || (_cache[16] = _createElementVNode(\"h3\", null, \"Ваши данные:\", -1 /* HOISTED */)), _createElementVNode(\"form\", {\n    onSubmit: _withModifiers($setup.handleSubmit, [\"prevent\"])\n  }, [_createElementVNode(\"ul\", _hoisted_2, [_createElementVNode(\"li\", _hoisted_3, [_cache[5] || (_cache[5] = _createElementVNode(\"strong\", null, \"Имя:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => $setup.form.name = $event),\n    type: \"text\",\n    class: \"form-control\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.name]])]), _createElementVNode(\"li\", _hoisted_4, [_cache[6] || (_cache[6] = _createElementVNode(\"strong\", null, \"Фамилия:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.form.firstname = $event),\n    type: \"text\",\n    class: \"form-control\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.firstname]])]), _createElementVNode(\"li\", _hoisted_5, [_cache[7] || (_cache[7] = _createElementVNode(\"strong\", null, \"Почта:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.form.email = $event),\n    type: \"email\",\n    class: \"form-control\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.email]])]), _createElementVNode(\"li\", _hoisted_6, [_cache[8] || (_cache[8] = _createElementVNode(\"strong\", null, \"Телеграм:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[3] || (_cache[3] = $event => $setup.form.telegram = $event),\n    type: \"text\",\n    class: \"form-control\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.telegram]])]), _createElementVNode(\"li\", _hoisted_7, [_cache[9] || (_cache[9] = _createElementVNode(\"strong\", null, \"Login:\", -1 /* HOISTED */)), _withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => $setup.form.username = $event),\n    type: \"text\",\n    class: \"form-control\",\n    required: \"\"\n  }, null, 512 /* NEED_PATCH */), [[_vModelText, $setup.form.username]])]), _createElementVNode(\"li\", _hoisted_8, [_cache[10] || (_cache[10] = _createElementVNode(\"strong\", null, \"Должность:\", -1 /* HOISTED */)), _cache[11] || (_cache[11] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.form.user_type || 'Не указано'), 1 /* TEXT */)]), _createElementVNode(\"li\", _hoisted_9, [_cache[12] || (_cache[12] = _createElementVNode(\"strong\", null, \"Цех:\", -1 /* HOISTED */)), _cache[13] || (_cache[13] = _createElementVNode(\"br\", null, null, -1 /* HOISTED */)), _createTextVNode(\" \" + _toDisplayString($setup.form.workshops.length ? $setup.form.workshops.join(', ') : 'Не указано'), 1 /* TEXT */)])]), _cache[14] || (_cache[14] = _createElementVNode(\"button\", {\n    type: \"submit\",\n    class: \"btn btn-primary\"\n  }, \"Сохранить изменения\", -1 /* HOISTED */))], 32 /* NEED_HYDRATION */), _createVNode(_component_router_link, {\n    to: \"/profile/password\",\n    class: \"btn btn-warning mt-3\"\n  }, {\n    default: _withCtx(() => _cache[15] || (_cache[15] = [_createTextVNode(\"Изменить пароль\")])),\n    _: 1 /* STABLE */\n  })]);\n}","map":{"version":3,"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","onSubmit","_withModifiers","$setup","handleSubmit","_hoisted_2","_hoisted_3","_cache","$event","form","name","type","required","_hoisted_4","firstname","_hoisted_5","email","_hoisted_6","telegram","_hoisted_7","username","_hoisted_8","_createTextVNode","_toDisplayString","user_type","_hoisted_9","workshops","length","join","_createVNode","_component_router_link","to","default","_withCtx","_"],"sources":["C:\\Users\\nikec\\frontend\\src\\components\\ProfilePage.vue"],"sourcesContent":["<template>\r\n    <div class=\"container mt-4\">\r\n      <h3>Ваши данные:</h3>\r\n  \r\n      <form @submit.prevent=\"handleSubmit\">\r\n        <ul class=\"list-group mb-4\">\r\n          <li class=\"list-group-item\">\r\n            <strong>Имя:</strong>\r\n            <input v-model=\"form.name\" type=\"text\" class=\"form-control\" required />\r\n          </li>\r\n          <li class=\"list-group-item\">\r\n            <strong>Фамилия:</strong>\r\n            <input v-model=\"form.firstname\" type=\"text\" class=\"form-control\" />\r\n          </li>\r\n          <li class=\"list-group-item\">\r\n            <strong>Почта:</strong>\r\n            <input v-model=\"form.email\" type=\"email\" class=\"form-control\" />\r\n          </li>\r\n          <li class=\"list-group-item\">\r\n            <strong>Телеграм:</strong>\r\n            <input v-model=\"form.telegram\" type=\"text\" class=\"form-control\" />\r\n          </li>\r\n          <li class=\"list-group-item\">\r\n            <strong>Login:</strong>\r\n            <input v-model=\"form.username\" type=\"text\" class=\"form-control\" required />\r\n          </li>\r\n          <li class=\"list-group-item\">\r\n            <strong>Должность:</strong><br />\r\n            {{ form.user_type || 'Не указано' }}\r\n          </li>\r\n          <li class=\"list-group-item\">\r\n            <strong>Цех:</strong><br />\r\n            {{ form.workshops.length ? form.workshops.join(', ') : 'Не указано' }}\r\n          </li>\r\n        </ul>\r\n  \r\n        <button type=\"submit\" class=\"btn btn-primary\">Сохранить изменения</button>\r\n      </form>\r\n  \r\n      <router-link to=\"/profile/password\" class=\"btn btn-warning mt-3\">Изменить пароль</router-link>\r\n    </div>\r\n  </template>\r\n  \r\n  <script setup>\r\n  import { reactive } from 'vue'\r\n  import { useRouter } from 'vue-router'\r\n  \r\n  const router = useRouter()\r\n  \r\n  const form = reactive({\r\n    name: 'Не указано',\r\n    firstname: '',\r\n    email: '',\r\n    telegram: '',\r\n    username: '',\r\n    user_type: '',\r\n    workshops: [], // список цехов\r\n  })\r\n  \r\n  const isEmptyOrDefault = (value) => !value.trim() || value.trim().toLowerCase() === 'не указано'\r\n  \r\n  const isCyrillic = (text) => /^[А-ЯЁ][а-яё]+$/.test(text)\r\n  \r\n  const handleSubmit = async () => {\r\n    let errors = []\r\n  \r\n    if (isEmptyOrDefault(form.name) || !isCyrillic(form.name)) {\r\n      errors.push('Имя должно содержать только кириллицу, первая буква заглавная.')\r\n    }\r\n  \r\n    if (form.firstname && !isCyrillic(form.firstname)) {\r\n      errors.push('Фамилия должна содержать только кириллицу, первая буква заглавная.')\r\n    }\r\n  \r\n    if (form.email && !/^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/.test(form.email)) {\r\n      errors.push('Введите корректный email.')\r\n    }\r\n  \r\n    if (form.telegram && !/^@[a-zA-Z0-9_]{5,}$/.test(form.telegram)) {\r\n      errors.push('Введите корректный Telegram (например, @username).')\r\n    }\r\n  \r\n    if (isEmptyOrDefault(form.username) || form.username.length < 3) {\r\n      errors.push('Логин должен содержать минимум 3 символа.')\r\n    }\r\n  \r\n    if (errors.length) {\r\n      alert('Исправьте ошибки:\\n\\n' + errors.join('\\n'))\r\n      return\r\n    }\r\n  \r\n    // Отправка данных на сервер\r\n    try {\r\n      const response = await fetch('/profile', {\r\n        method: 'POST',\r\n        headers: { 'Content-Type': 'application/json' },\r\n        body: JSON.stringify(form),\r\n      })\r\n  \r\n      if (!response.ok) throw new Error('Ошибка при сохранении данных.')\r\n      alert('Данные успешно сохранены!')\r\n      router.push('/api/home')\r\n    } catch (e) {\r\n      alert(e.message)\r\n    }\r\n  }\r\n  </script>\r\n  \r\n  <style scoped>\r\n  .container {\r\n    max-width: 600px;\r\n  }\r\n  </style>\r\n  "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}